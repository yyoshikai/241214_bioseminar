


# Fig. 1. General biomolecular modeling with RFAA.
(A) RFAA takes input information about the molecular composition of the biomolecular assembly to be modeled, including protein amino acid and nucleic acid base sequences, metal ions, small molecule–bonded structure, and covalent bonds between small molecules and proteins. (B) Processing of molecular input information. Small-molecule information is parsed into element types (46 possible types), bond types, and chiral centers. Covalent bonds between proteins and small molecules are provided as a separate token in the bond adjacency matrix. The three-track architecture mixes 1D, 2D, and 3D information and predicts all-atom coordinates and model confidence. Single-letter abbreviations for amino acid residues in the figures are as follows: A, Ala; C, Cys; D, Asp; E, Glu; F, Phe; G, Gly; H, His; I, Ile; K, Lys; L, Leu; M, Met; N, Asn; P, Pro; Q, Gln; R, Arg; S, Ser; T, Thr; V, Val; W, Trp; and Y, Tyr.
    (A) RFAAは、タンパク質のアミノ酸配列や核酸塩基配列、金属イオン、低分子結合構造、低分子とタンパク質の共有結合など、モデル化する生体分子集合体の分子構成に関する入力情報を受け取る。(B）分子入力情報の処理。低分子情報は元素タイプ（46種類）、結合タイプ、キラル中心に解析される。タンパク質と低分子間の共有結合は、結合隣接行列の別のトークンとして提供される。1次元、2次元、3次元の情報をミックスし、全原子座標とモデル信頼度を予測する3トラックアーキテクチャ。図中のアミノ酸残基の1文字略号は以下の通りである： A, Ala; C, Cys; D, Asp; E, Glu; F, Phe; G, Gly; H, His; I, Ile; K, Lys; L, Leu; M, Met; N, Asn; P, Pro; Q, Gln; R, Arg; S, Ser; T, Thr; V, Val; W, Trp; Y, Tyr。

# Fig. 2. RFAA can accurately predict protein–small molecule complex structures.
(A) Every “atom” node is assigned a local coordinate frame based on the identities of its neighbors. To compute the main loss in the network, we aligned each atom’s coordinate frame in the predicted and true structures and measured the error over all the other atoms. (B) Model accuracy correlates with error predictions. Structures and corresponding error predictions were generated for CAMEO targets (05/20/23 to 7/29/23; 261 protein–small molecule interfaces). Ligand RMSD was computed by CAMEO organizers. (C) RFAA outperforms AutoDock Vina on CAMEO targets (week 8/12/23 to 09/02/23; 149 protein–small molecule interfaces). Both servers had to model the protein and find pockets for all ligands present in the solved structure and the correct docks for all ligands. The ligand RMSD for both servers was computed by CAMEO organizers; the AutoDock Vina server was set up by CAMEO organizers. (D) Three examples of successful predictions with multiple biomolecules. Shown from left to right are fatty acid decarboxylase (PDB ID 8D8P; seq ID 34%; from CAMEO) with a heme cofactor and a lipid substrate; a dimeric tyrosine methyltransferase (PDB ID 7UX8; seq ID 28%; CASP15 target: T1124) with an S-adenosyl homocysteine and tyrosine interaction; and a DNA polymerase (PDB ID 7U7W; seq ID 100%) bound to DNA, a nucleotide, and a metal ion (31, 66, 67). The following color scheme is used in all panels: Predicted protein structure (aligned to native) is indicated in transparent teal, predicted ligand conformation in teal, and native ligand conformation in gray. (E) Comparison to other deep learning–based docking methods. In this case, each method was applied in their respective training regime. For RFAA, this meant only having sequence and minimal atomic graph inputs, whereas for other methods, this involved providing the bound crystal structure. The ligand RMSD was computed using the PoseBusters suite, and a single example present in our training set was removed for all methods that were compared. (F) Comparison of RFAA predictions on recently solved PDB proteins that are new compared with the training set (homolog <1 BLAST e-value, similar ligand >0.5 Tanimoto similarity). Each set is clustered based on sequence or ligand similarity, and a random cluster representative is chosen for each. (G) Comparison of RFAA prediction accuracy to Rosetta ΔG energy estimates for the native complex (more than 940 cases that were successfully processed by Rosetta). RFAA makes more-accurate predictions for native complexes with low Rosetta energy. (H) Three examples of successful predictions with low similarity to the training set. Shown from left to right are G protein–coupled S1P receptor (PDB ID 7EW1; seq ID 31%), complex of DLK bound to an inhibitor (PDB ID 8OUS; seq ID 39%), and a Renilla luciferase bound to an azacoelenterazine (non-native substrate; PDB ID 7QXR; seq ID 23%) (68–70). In (B), (F), and (G), boxplots cut off at 20 Å for clarity; the center line represents the median, box limits are upper and lower quartiles, and whiskers are minimum and maximum values. The color scheme is the same as that in (D).
    (A)各「原子」ノードには、その近傍ノードのアイデンティティに基づいてローカル座標フレームが割り当てられる。ネットワークの主な損失を計算するために、予測された構造と真の構造における各原子の座標フレームを整列させ、他のすべての原子に対する誤差を測定した。(B)モデルの精度は誤差予測と相関する。CAMEOターゲット（05/20/23から7/29/23、261のタンパク質-低分子界面）に対して、構造と対応する誤差予測を生成した。リガンドのRMSDはCAMEOオーガナイザーによって計算された。(C）CAMEOターゲット（8/12/23～09/02/23週、149タンパク質-低分子界面）において、RFAAはAutoDock Vinaを上回った。両サーバーとも、タンパク質をモデリングし、解かれた構造に存在するすべてのリガンドのポケットと、すべてのリガンドに対して正しいドックを見つける必要がありました。両サーバーのリガンドRMSDはCAMEOのオーガナイザーによって計算され、AutoDock VinaサーバーはCAMEOのオーガナイザーによって設定された。(D）複数の生体分子を用いて予測に成功した3つの例。左から、ヘム補酵素と脂質基質を持つ脂肪酸脱炭酸酵素（PDB ID 8D8P; seq ID 34%; CAMEOより）、S-アデノシルホモシステインとチロシン相互作用を持つ二量体チロシンメチルトランスフェラーゼ（PDB ID 7UX8; seq ID 28%; CASP15 target： S-アデノシルホモシステインとチロシンの相互作用を持つDNAポリメラーゼ（PDB ID 7U7W; seq ID 100%）、DNA、ヌクレオチド、金属イオンに結合したDNAポリメラーゼ（PDB ID 7U7W; seq ID 100%）である(31, 66, 67)。すべてのパネルで以下の配色を用いている： 予測されたタンパク質構造（ネイティブに整列）は透明のティール色、予測されたリガンドのコンフォメーションはティール色、ネイティブのリガンドのコンフォメーションはグレーで示されている。 E）他の深層学習ベースのドッキング手法との比較。この場合、各手法はそれぞれの学習レジームで適用された。RFAAの場合は、配列と最小原子グラフの入力のみであったが、他の手法の場合は、結合結晶構造の入力が必要であった。リガンドのRMSDはPoseBustersスイートを使って計算し、比較したすべてのメソッドについて、トレーニングセットに存在する1つの例を取り除いた。(F)トレーニングセット（ホモログ<1 BLAST e-value、類似リガンド>0.5 Tanimoto similarity）と比較して新しい最近解決されたPDBタンパク質に対するRFAAの予測値の比較。各セットは配列またはリガンドの類似性に基づいてクラスタ化され、それぞれランダムにクラスタ代表が選ばれる。(G)ネイティブ複合体（Rosettaで正常に処理された940以上のケース）に対するRFAAの予測精度とRosettaのΔGエネルギー推定値の比較。RFAAは、ロゼッタのエネルギーが低いネイティブ複合体に対して、より正確な予測を行う。(H)トレーニングセットとの類似性が低く、予測に成功した3つの例。左からGタンパク質共役型S1P受容体（PDB ID 7EW1; seq ID 31%）、阻害剤と結合したDLKの複合体（PDB ID 8OUS; seq ID 39%）、アザコエンテラジン（非ネイティブ基質; PDB ID 7QXR; seq ID 23%）と結合したレニラ・ルシフェラーゼ（68-70）。(B)、(F)、(G)では、わかりやすくするために20Åで切り取った箱ひげ図である。中央の線は中央値、箱ひげは上下四分位数、ひげは最小値と最大値を表す。配色は(D)と同じ。

# Fig. 3. Accurate prediction of protein covalent modifications.
(A) Schematic describing how RFAA models covalent modifications to proteins. The chemical moiety that modifies the residue and the residue are modeled as atom nodes, and the rest of the protein is modeled as residues (with multiple sequence alignment and template inputs). (B) Model accuracy correlates with predicted error on a set of 938 recently solved structures with covalent modifications. Modification RMSD was computed by aligning the protein structure within 10 Å and computing RMSD over the modified residue and chemical modification. The boxplot is cut off at 15 Å for clarity. (C) Comparison of sequence identity to the training set and model accuracy. Models are generally accurate even with low sequence homology to the training set. (D) Comparison of model accuracy for different types of covalent modifications.  (E) Shown at the top is an example of a successfully predicted covalently linked enzyme cofactor (PDB ID 7P3T; seq ID 28%), which is a structure of an (R)-selective amine transaminase. Shown at the bottom is an example of a covalently bound drug candidate (PDB ID 7TI1; seq ID 27%), which is a β-lactamase enzyme bound to cyclic boronic acid inhibitor (71, 72). (F) Accurate predictions of glycans on the N-acetylglucosamine-1-phosphotransferase (GNPT) gamma subunit (PDB ID 7S69; no BLAST hits) (right) and human sperm TMEM95 ectodomain (PDB ID 7UX0; seq ID 26%) (left) (41, 42). For the boxplots in (B) to (D), the center line represents the median, box limits are upper and lower quartiles, and whiskers are minimum and maximum values. In (E) and (F), predicted protein structure is indicated in transparent teal, native structure in transparent gray, predicted covalent modification in teal, and native covalent modification in gray.
    (A) RFAAがタンパク質の共有結合修飾をどのようにモデル化するかを説明する模式図。残基を修飾する化学部分と残基は原子ノードとしてモデル化され、タンパク質の残りの部分は残基としてモデル化される（マルチプル配列アライメントとテンプレート入力を使用）。(B）共有結合修飾を持つ最近解決された938の構造セットについて、モデル精度と予測誤差の相関を示した。修飾RMSDは、タンパク質構造を10Å以内にアライメントし、修飾残基と化学修飾に対するRMSDを計算することによって計算した。ボックスプロットはわかりやすくするために15Åで切ってある。(C）トレーニングセットとの配列同一性とモデルの精度の比較。トレーニングセットとの配列相同性が低くても、モデルは概して正確である。(D) 異なるタイプの共有結合修飾に対するモデル精度の比較。 (E）上に示したのは、うまく予測された共有結合した酵素補酵素（PDB ID 7P3T; seq ID 28%）の例で、（R）-選択的アミントランスアミナーゼの構造である。これは環状ボロン酸阻害剤と結合したβ-ラクタマーゼ酵素である(71,72)。(F）N-アセチルグルコサミン-1-ホスホトランスフェラーゼ（GNPT）ガンマサブユニット（PDB ID 7S69；BLASTヒットなし）（右）とヒト精子TMEM95エクトドメイン（PDB ID 7UX0；seq ID 26％）（左）上の糖鎖の正確な予測（41,42 ）。(B)～(D)の箱ひげ図では、中央の線は中央値、箱ひげは上下四分位数、ひげは最小値と最大値を表す。(E)と(F)では、予測されたタンパク質構造は透明な水色、ネイティブ構造は透明な灰色、予測された共有結合修飾は水色、ネイティブの共有結合修飾は灰色で示されている。

# Fig. 4. Experimental characterization of binders designed with RFdiffusionAA.
The following color scheme is used in all panels: The input ligand is indicated in yellow, input protein motif in blue, and diffused protein in teal; purple text indicates the closest TM score to any protein in the training set, and blue text indicates the closest TM score to any protein in the training set that has a similar ligand bound (Tanimoto similarity >0.5). (A) Schematic depicting the random initialization of residues surrounding a small molecule and progressive denoising by RFdiffusionAA. (B) Characterization of dioxigenin binder design. Shown from left to right are the input motif to RFdiffusionAA, the designed protein, a zoomed-in view of the binding-site side chains, isothermal calorimetry (ITC) measuring binding affinity (Kd = 343 nM), and a circular dichroism (CD) trace (26 μM protein concentration; the inset is a CD melt showing intensity at 220 nm across a broad range of temperatures). ΔH, enthalpy of binding; MRE, molar ellipticity.(C) Characterization of heme binding designs. Shown from left to right are the input motif to RFdiffusionAA, the designed protein aligned to its crystal structure (PDB ID 8VC8), a zoomed-in view of the binding site, and UV-Vis spectra showing that the designed protein matches the expected spectra for penta-coordinated heme and that mutating cysteine to alanine abolishes binding (top) and that the designed protein retains heme binding at temperatures up to 90°C (bottom). (D) Characterization of bilin binding designs. Row 1, left to right, shows the input motif to RFdiffusionAA and three designs with different predicted structural topologies. Row 2, left to right, shows a zoomed-in view of binding sites for each design. Row 3, left to right, shows normalized absorption spectra for the three designs. The designs have a range of maximum absorption wavelengths and hence different colors in solution (insets).
    全てのパネルで以下の配色を用いている： 入力リガンドは黄色、入力タンパク質モチーフは青色、拡散されたタンパク質は青緑色で示されている。紫色のテキストは、トレーニングセット中のどのタンパク質にも最も近いTMスコアを示し、青色のテキストは、類似のリガンドが結合した（谷本類似度>0.5）トレーニングセット中のどのタンパク質にも最も近いTMスコアを示す。(A) 小分子を囲む残基のランダム初期化とRFdiffusionAAによる漸進的ノイズ除去を示す模式図。(B）ジオキシゲニンのバインダーデザインの特徴。左からRFdiffusionAAへの入力モチーフ、設計されたタンパク質、結合部位側鎖の拡大図、結合親和性（Kd= 343 nM）を測定する等温熱量測定（ITC）、円偏光二色性（CD）トレース（タンパク質濃度26 μM、挿入図は広い温度範囲にわたって220 nmの強度を示すCDメルト）。ΔHは結合エンタルピー、MREはモル楕円率。(C）ヘム結合デザインの特性評価。左から順に、RFdiffusionAAへの入力モチーフ、結晶構造（PDB ID 8VC8）に整列させたデザインタンパク質、結合部位の拡大図、デザインタンパク質がペンタ配位ヘムに期待されるスペクトルと一致すること、システインをアラニンに変異させると結合が消失すること（上）、デザインタンパク質が90℃までの温度でヘム結合を保持すること（下）を示すUV-Visスペクトル。(D）ビリン結合設計の特性評価。1行目、左から右に、RFdiffusionAAへの入力モチーフと、異なる構造トポロジーを予測した3つのデザインを示す。2行目、左から右へ、各デザインの結合部位の拡大図。3行目、左から右へ、3つのデザインの正規化吸収スペクトルを示す。それぞれのデザインは最大吸収波長の幅があり、したがって溶液中の色も異なる（挿入図）。















