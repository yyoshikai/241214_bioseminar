
# Editor’s summary
    近年ではタンパク質の構造予測はポリペプチド鎖のみである。本論文では, 生体内で重要な役割を果たす低分子, 金属イオン, 核酸や多様な結合方式を考慮した予測モデルを開発した。
    また補酵素に結合するタンパク質を設計し, それを実験的に検証した。
Advances in machine learning have made protein structure prediction and design much more accurate and accessible in recent years, but these tools have generally been limited to polypeptide chains. However, ligands such as small molecules, metal ions, and nucleic acids are crucial components of most proteins, both in terms of structure and biological function. Krishna et al. present a next-generation protein structure prediction and design tool, RoseTTAFold All-Atom, that can accept a wide range of ligands and covalent amino acid modifications. The authors demonstrate superior performance on protein-ligand structure prediction relative to other tools, even in the absence of an input experimental structure. They also perform de novo design of proteins to bind cofactors and small molecules and experimentally validate these designs. —Michael A. Funk
    近年、機械学習の進歩により、タンパク質の構造予測や設計はより正確で利用しやすくなったが、これらのツールは一般的にポリペプチド鎖に限定されていた。しかし、低分子、金属イオン、核酸などのリガンドは、構造と生物学的機能の両面において、ほとんどのタンパク質にとって極めて重要な構成要素である。Krishnaらは、次世代のタンパク質構造予測・設計ツールであるRoseTTAFold All-Atomを発表した。このツールは、幅広いリガンドや共有結合のアミノ酸修飾を受け入れることができる。著者らは、実験的な構造が入力されていない場合でも、タンパク質-リガンド構造予測において他のツールよりも優れた性能を実証している。また、補酵素や低分子に結合するタンパク質のde novo設計を行い、これらの設計を実験的に検証している。-マイケル・A・ファンク

# Structured Abstract
## INTRODUCTION
    タンパク質は, 生体内では核酸・他のタンパク質・小分子などと協調して働くが, 既存のタンパク質構造予測はポリペプチド鎖においてのみ発展している。
Proteins rarely act alone; they form complexes with other proteins in cell signaling, interact with DNA and RNA during transcription and translation, and interact with small molecules both covalently and noncovalently during metabolism and signaling. Despite substantial recent progress in protein-only structure prediction, modeling such general biomolecular assemblies remains an outstanding challenge.
    タンパク質は単独で機能することは稀である。細胞シグナル伝達において他のタンパク質と複合体を形成し、転写や翻訳においてDNAやRNAと相互作用し、代謝やシグナル伝達において共有結合的・非共有結合的に小分子と相互作用する。 タンパク質のみの構造予測は最近大きく進歩したが、このような一般的な生体分子集合体のモデリングは依然として未解決の課題である。

## RATIONALE
    本論文では, (AlphaFoldで使われているような)配列ベースの情報と, 原子間の非共有結合情報を両方考慮することを目指した。RoseTTAFold2は, 配列情報, MSA,  MSAテンプレートからのペアワイズ情報を考慮して処理する。
We set out to develop a unified structure prediction and design approach for assemblies containing proteins, nucleic acids, small molecules, metals, and chemical modifications. We sought to combine a sequence-based description of proteins and nucleic acids with an atomic graph representation of small molecules and protein covalent modifications. We started with the RoseTTAFold2 (RF2) network, which takes as input one-dimensional (1D) sequence information, 2D pairwise distance information from homologous templates, and 3D coordinate information and iteratively improves predicted structures through many hidden layers.
    我々は、タンパク質、核酸、低分子、金属、化学修飾を含む集合体の統一的な構造予測と設計アプローチの開発に着手した。 タンパク質と核酸の配列ベースの記述と、低分子とタンパク質の共有結合修飾の原子グラフ表現を組み合わせることを目指した。 RoseTTAFold2(RF2)ネットワークは、1次元(1D)配列情報、相同テンプレートからの2次元ペアワイズ距離情報、3次元座標情報を入力とし、多くの隠れ層を通して予測構造を反復的に改善する。

## RESULTS
    RF2の上にあるRFAAでは, RF2からのタンパク質・核酸の表現を使い, 低分子はグラフとして表現する。原子の種類・結合の種類・キラリティを入力とする。モデル中ではタンパク質の残基やリガンドの原子がガスのように自由に動き, だんだん妥当な構造になるように移動して構造を生成する。
For our biomolecular structure prediction network RoseTTAFold All-Atom (RFAA) (see the figure, top), we retained the representations of protein and nucleic acid chains from RF2 and represented arbitrary small molecules as atom-bond graphs. To the 1D track, we input the chemical element type of each nonpolymer atom; to the 2D track, the chemical bonds between atoms; and to the 3D track, information on chirality. Immediately after input, the full system was represented as a disconnected gas of amino acid residues, nucleic acid bases, and freely moving atoms, which was successively transformed through the many blocks of the network into physically plausible assembly structures. We trained RFAA on protein–small molecule, protein-metal, and covalently modified protein complexes that are found in the Protein Data Bank (PDB), filtering out common solvents and crystallization additives.
    生体分子構造予測ネットワークRoseTTAFold All-Atom (RFAA)（上図参照）では、RF2のタンパク質鎖と核酸鎖の表現を継承し、任意の低分子を原子結合グラフとして表現した。 1次元トラックには各非ポリマー原子の化学元素タイプを、2次元トラックには原子間の化学結合を、3次元トラックにはキラリティの情報を入力した。 入力直後から、全システムはアミノ酸残基、核酸塩基、自由に動く原子からなる切断された気体として表現され、ネットワークの多くのブロックを介して、物理的にもっともらしい集合体構造に順次変換された。 タンパク質データバンク（PDB）にあるタンパク質-低分子、タンパク質-金属、共有結合で修飾されたタンパク質複合体について、一般的な溶媒や結晶化添加物を除外してRFAAの学習を行った。

    
     CAMEOベンチマークでは自動パイプラインを凌駕した(...AlphaFold2とかは上回らなかったのか?)。精度と相関する信頼度を出力した。また, 配列相同性やリガンドの(何との?)谷本係数が低いものでも高い予測精度を示した。
In the CAMEO blind ligand-docking challenge, RFAA outperforms baseline automated pipelines. Although not all predictions are accurate, the network outputs a confidence estimate that correlates with accuracy. The network generalizes beyond the training set: Accurate predictions are made for proteins with low sequence homology (BLAST e-value >1) and ligands with low similarity (Tanimoto similarity <0.5) to those in the training set. Prediction accuracy is higher for protein–small molecule complexes with more-favorable computed interaction energies using a molecular mechanics force field, which suggests that RFAA has learned aspects of the physical chemistry of protein–small molecule interactions. Nearly half (46%) of covalent modifications are predicted accurately [<2.5-Å root mean square deviation (RMSD)]. These additional prediction capabilities do not come at the expense of the protein structure–prediction task because RFAA has a prediction accuracy on protein monomer structures comparable to that AlphaFold2.
    CAMEOのブラインド・リガンド・ドッキング・チャレンジでは、RFAAはベースラインの自動パイプラインを凌駕しました。 すべての予測が正確なわけではありませんが、ネットワークは精度と相関する信頼度の推定値を出力します。 ネットワークはトレーニングセットを超えて汎化する： 低い配列相同性（BLAST e-value > 1）を持つタンパク質や、トレーニングセットと低い類似性（Tanimoto similarity <0.5）を持つリガンドに対しても、正確な予測が行われる。 予測精度は、分子力学的力場を用いて計算された相互作用エネルギーがより好ましいタンパク質-低分子複合体に対してより高く、これはRFAAがタンパク質-低分子相互作用の物理化学的側面を学習していることを示唆している。 共有結合修飾の半数近く（46%）は正確に予測された [<2.5-Å二乗平均平方根偏差(RMSD)]。 RFAAのタンパク質単量体構造の予測精度はAlphaFold2と同等であるため、このような付加的な予測機能がタンパク質構造予測タスクを犠牲にすることはありません。 

    RFAAをfine tuningすることで, RFDiffusionにも応用した。名付けてRFdiffusionAA。ジゴキシゲニン, 補酵素ヘム, ビリン分子に結合するタンパク質を設計した。またそれぞれが目的の活性を持っていることを示した。
For small-molecule binder design, we developed RFdiffusion All-Atom (RFdiffusionAA) by fine-tuning RFAA on diffusion denoising tasks. Starting from random residue distributions, RFdiffusionAA generates folded protein structures that surround the small molecule. In contrast to previous approaches that rely on native or preexisting designed scaffolds, the binding pockets are custom generated for each ligand of interest. We generated small-molecule binding designs for the cardiac disease drug digoxigenin, the enzyme cofactor heme, and optically active bilin molecules. In each case, experimental characterization showed that a subset of the designs had the designed binding activity. The crystal structure of a heme binding design matched the RFdiffusionAA model very closely (0.86-Å Cα RMSD).
    低分子バインダー設計のために、RFAAの拡散ノイズ除去タスクを微調整することで、RFdiffusion All-Atom (RFdiffusionAA)を開発しました。 ランダムな残基分布から出発して、RFdiffusionAAは低分子を取り囲む折り畳まれたタンパク質構造を生成する。 ネイティブまたは既存の設計されたスキャフォールドに依存する従来のアプローチとは対照的に、結合ポケットは、関心のあるリガンドごとにカスタムで生成される。 我々は、心疾患治療薬ジゴキシゲニン、酵素補酵素ヘム、光学活性ビリン分子の低分子結合デザインを作成した。 それぞれの場合において、実験的特性評価により、デザインのサブセットがデザインされた結合活性を持つことが示された。 ヘム結合デザインの結晶構造は、RFdiffusionAAモデルと非常によく一致した（Cα RMSD 0.86Å）。

## CONCLUSION
    RFAAにより, 非タンパク質成分を含む構造予測モデルを学習できることが示された。予測精度には改善の余地があるが, RFAAはタンパク質などのモデリング(=構造予測?), RFDiffusionAAはリガンド結合タンパク質の設計に役立つと期待される。
RFAA demonstrates that a single neural network can be trained to accurately model general biomolecular assemblies containing a wide diversity of nonprotein components. Although there is still room for improvement in prediction accuracy, we anticipate that RFAA should be broadly useful for modeling full biological assemblies and RFdiffusionAA for designing small molecule–binding proteins and sensors.
    RFAAは、多様な非タンパク質成分を含む一般的な生体分子集合体を正確にモデル化するために、単一のニューラルネットワークをトレーニングできることを示している。 予測精度にはまだ改善の余地があるが、RFAAは完全な生体分子集合体のモデリングに、RFdiffusionAAは低分子結合タンパク質やセンサーの設計に広く役立つと期待される。

# Abstract
    既存のタンパク質の構造予測・設計はタンパク質のみに限られる。本論文のRoseTTAFold All-Atomは, タンパク質のアミノ酸・核酸の残基ベースの表現と, 原子ベースのその他分子の表現を組み合わせ,  RFAAを開発した。またdiffusion modelに応用し, RFDiffusionAAを開発した。ジゴキシゲニン, ヘム, ビリンと結合するタンパク質を設計し, その活性を検証した。
Deep-learning methods have revolutionized protein structure prediction and design but are presently limited to protein-only systems. We describe RoseTTAFold All-Atom (RFAA), which combines a residue-based representation of amino acids and DNA bases with an atomic representation of all other groups to model assemblies that contain proteins, nucleic acids, small molecules, metals, and covalent modifications, given their sequences and chemical structures. By fine-tuning on denoising tasks, we developed RFdiffusion All-Atom (RFdiffusionAA), which builds protein structures around small molecules. Starting from random distributions of amino acid residues surrounding target small molecules, we designed and experimentally validated, through crystallography and binding measurements, proteins that bind the cardiac disease therapeutic digoxigenin, the enzymatic cofactor heme, and the light-harvesting molecule bilin.
    ディープラーニング手法は、タンパク質の構造予測と設計に革命をもたらしたが、現在のところタンパク質のみのシステムに限られている。 我々は、RoseTTAFold All-Atom (RFAA)について述べる。RFAAは、アミノ酸とDNA塩基の残基ベースの表現と、他の全てのグループの原子表現を組み合わせ、配列と化学構造が与えられたタンパク質、核酸、低分子、金属、共有結合修飾を含む集合体をモデル化する。 ノイズ除去タスクを微調整することにより、我々はRFdiffusion All-Atom (RFdiffusionAA)を開発した。 標的低分子を取り囲むアミノ酸残基のランダム分布から出発して、心疾患治療薬ジゴキシゲニン、酵素補酵素ヘム、および光捕集分子ビリンと結合するタンパク質を設計し、結晶学と結合測定を通して実験的に検証した。

# Main
    タンパク質の構造予測はAF2やRFにより大幅に進歩したが, 自然界ではタンパク質は核酸, 低分子と相互作用しながら働いている。これらを予測することは難しい。RFは核酸と共同で予測するよう拡張されたが(RFNA), 他の分子も含めて考えるのは難しい。
The deep neural networks AlphaFold2 (AF2) (1) and RoseTTAFold (RF) (2) enable high-accuracy prediction of protein structures from amino acid sequences. However, in nature, proteins rarely act alone; they form complexes with other proteins in cell signaling, interact with DNA and RNA during transcription and translation, and interact with small molecules, both covalently and noncovalently, during metabolism and signaling. Modeling such general biomolecular assemblies composed of polypeptide chains, covalently modified amino acids, nucleic acid chains, and arbitrary small molecules remains an outstanding challenge. One approach is to model the protein chains using AF2 or RF and then successively add in the nonprotein components using classical docking methods (3–9); however, systematically evaluating and optimizing such procedures is not straightforward. RF has been extended to model both protein and nucleic acids by increasing the size of the residue alphabet to 28 (20 amino acids, four DNA bases, and four RNA bases) with RoseTTAFold nucleic acid (RFNA) (10), but general biomolecular system modeling is a more challenging problem, given the great diversity of possible small-molecule components. An approach capable of accurately predicting the three-dimensional (3D) structures of biomolecular assemblies starting only from knowledge of the constituent molecules (and not their 3D structures) would have a broad impact on structural biology and drug discovery and open the door to deep learning–based design of protein–small molecule assemblies.
    ディープニューラルネットワークAlphaFold2（AF2）（1）とRoseTTAFold（RF）（2）は、アミノ酸配列からタンパク質の構造を高精度に予測することができる。 しかし、自然界においてタンパク質が単独で機能することは稀であり、細胞内シグナル伝達において他のタンパク質と複合体を形成したり、転写や翻訳においてDNAやRNAと相互作用したり、代謝やシグナル伝達において共有結合的・非共有結合的に小分子と相互作用したりする。 ポリペプチド鎖、共有結合で修飾されたアミノ酸、核酸鎖、および任意の低分子からなる、このような一般的な生体分子集合体をモデル化することは、依然として未解決の課題である。 ひとつのアプローチは、AF2やRFを用いてタンパク質鎖をモデル化し、古典的なドッキング手法を用いて非タンパク質成分を順次追加していく方法である(3-9)。しかし、このような手順を系統的に評価し、最適化することは容易ではない。 RFは、RoseTTAFold核酸(RFNA)(10)により残基アルファベットを28(20アミノ酸、4DNA塩基、4RNA塩基)に増やすことで、タンパク質と核酸の両方をモデル化するように拡張されたが、一般的な生体分子系のモデリングは、考え得る低分子成分の多様性を考えると、より困難な問題である。 生体分子集合体の3次元（3D）構造を、構成分子（3D構造ではなく）の知識のみから正確に予測できるアプローチは、構造生物学と創薬に広範な影響を与え、深層学習に基づくタンパク質-低分子集合体の設計への扉を開くだろう。

    そこで私たちは低分子なども含む3次元構造予測モデルの開発に着手したが, 最初の問題は低分子をどう表現するかということだった。タンパク質は配列として表現されており, 核酸には容易に拡張できたが, 低分子はポリマーでないため使えない。そこで, 分子は原子を頂点, 結合をエッジとするグラフで表現し, 分子とタンパク質の共有結合のグラフも含めて表現するようにした。
We set out to develop a structure prediction method capable of generating 3D coordinates for all atoms of a biological unit, including proteins, nucleic acids, small molecules, metals, and chemical modifications (Fig. 1A). The first obstacle we faced in taking on the broader challenge of generalized biomolecular system modeling was how to represent the components. Existing protein structure prediction networks represent proteins as linear chains of amino acids, and this representation can be readily extended to nucleic acids. However, many of the small molecules that proteins interact with are not polymers, and it is unclear how to model them as a linear sequence. A natural way to represent the bonded structure of small molecules is as graphs whose nodes are atoms and whose edges represent bond connectivity. This graph representation is not suitable for proteins because they contain many thousands of atoms; hence, modeling whole proteins at the atomic level is computationally intractable. To overcome this limitation, we sought to combine a sequence-based description of biopolymers (proteins and nucleic acids) with an atomic graph representation of small molecules and protein covalent modifications.
    私たちは、タンパク質、核酸、低分子、金属、化学修飾を含む、生物学的ユニットの全原子の3次元座標を生成できる構造予測手法の開発に着手した（図1A）。 一般化された生体分子システムのモデリングという広範な課題に取り組むにあたり、私たちが直面した最初の障害は、構成要素をどのように表現するかということでした。 既存のタンパク質構造予測ネットワークは、タンパク質をアミノ酸の直鎖として表現しており、この表現は核酸にも容易に拡張できる。 しかし、タンパク質が相互作用する低分子の多くはポリマーではなく、それらをどのように線形配列としてモデル化するかは不明である。 低分子の結合構造を表現する自然な方法は、ノードが原子で、エッジが結合の連結性を表すグラフである。 タンパク質には何千もの原子が含まれるため、このグラフ表現は適していない。したがって、タンパク質全体を原子レベルでモデル化することは計算上困難である。 この制限を克服するために、われわれは生体高分子（タンパク質と核酸）の配列ベースの記述と、低分子およびタンパク質の共有結合修飾の原子グラフ表現を組み合わせることを試みた。

# Generalizing structure prediction to all biomolecules
    RF2をベースに, タンパク質と核酸についてはそれで処理した上で, 低分子, 共有結合修飾, 非天然アミノ酸を分子グラフとして表現した。グラフの1次元情報には原子の種類, 2次元情報には結合の有無, 3次元情報にはキラリティを足した。
    アミノ酸・核酸の表現は1次元配列情報とconcatしたっぽい。
    1~3は全く別の枠組みでやっていそう。
    3次元部門においては, それらがなす角?の実際の値との差の勾配を入力の特徴とした。
        ... 推論時はどうするのか?
We modeled the network architecture after the RoseTTAFold2 (RF2) protein structure prediction network, which accepts 1D sequence information, 2D pairwise distance information from homologous templates, and 3D coordinate information and iteratively improves predicted structures through many hidden layers (11). We retained the representations of protein and nucleic acid chains from RF2 and represented arbitrary small molecules, covalent modifications, and unnatural amino acids as atom-bond graphs. To the 1D track, we input the chemical element type of each nonpolymer atom; to the 2D track, the chemical bonds between atoms; and to the 3D track, information on chirality [whether chiral centers are (R) or (S)]. For the 1D track, we supplemented the 20-residue and 8–nucleic acid base representation in RFNA with 46 new element-type tokens representing the most common element types found in the Protein Data Bank (PDB) (table S5). For the 2D track atom-bond embedding, we encoded pairwise information about whether bonds between pairs of atoms are single, double, triple, or aromatic. These features are linearly embedded and summed with the initial pair features at the beginning of every recycle of the network, which allows the network to learn about bond lengths, angles, and planarity. Because the 1D and 2D representations in the network are invariant to reflections, we encoded stereochemistry information in the third track by specifying the sign of angles between the atoms surrounding each chiral center (fig. S1); at each block in the 3D track, the gradient of the deviation of the actual angles from the ideal values (with respect to the current coordinates) was computed and provided as an input feature to the subsequent block (Fig. 1B).
    RoseTTAFold2(RF2)は、1次元配列情報、相同テンプレートからの2次元ペアワイズ距離情報、および3次元座標情報を受け入れ、多くの隠れ層を通して予測構造を反復的に改善する(11)。 RF2のタンパク質と核酸鎖の表現はそのままに、任意の低分子、共有結合修飾、非天然アミノ酸を原子結合グラフとして表現した。 1次元トラックには各非ポリマー原子の化学元素タイプを、2次元トラックには原子間の化学結合を、3次元トラックにはキラリティ（キラル中心が(R)か(S)か）に関する情報を入力した。 1Dトラックでは、RFNAの20残基と8核酸塩基の表現を、Protein Data Bank (PDB)で見られる最も一般的な要素タイプを表す46の新しい要素タイプトークンで補足した（表S5）。 2次元トラックの原子結合埋め込みでは、原子のペア間の結合が単結合、二重結合、三重結合、芳香族結合のいずれであるかをペアごとにエンコードした。 これらの特徴は線形に埋め込まれ、ネットワークの各リサイクルの最初に、最初のペア特徴と合計される。 ネットワークの1次元および2次元表現は反射に対して不変であるため、各キラル中心を囲む原子間の角度の符号を指定することにより、3番目のトラックで立体化学情報を符号化した（図S1）。3次元トラックの各ブロックで、（現在の座標に対する）理想値からの実際の角度の偏差の勾配を計算し、後続のブロックへの入力特徴として提供した（図1B）。

    分子グラフは入れ替えに対し不変なので, positional encodingはせずattentionの順列不変性を利用した。残基の座標に加え, 重原子の情報も同様に追加した。
Unlike proteins and nucleic acid sequences, molecular graphs are permutation invariant, and hence, the network should make the same prediction irrespective of small-molecule element token order. In AF2 and RF2, the sequence order of amino acids and bases is represented by a relative position encoding; for atoms, we omitted such an encoding and leveraged the permutation invariance of the network attention mechanisms. We also modified the coordinate updates: In AF2 and RF, protein residues are represented by the coordinates of the Cα and the orientation of the N-C-C rigid frame (or the P coordinate and the OP1-P-OP2 frame orientation in RFNA), and, along the 3D track, the network generates rotational updates to each frame orientation and translational updates to each coordinate. To generalize this representation in our biomolecular structure prediction network RoseTTAFold All-Atom (RFAA), heavy-atom coordinates are added to the 3D track and move independently based only on a predicted translational update to their position. Thus, immediately after input, the full system is represented as a disconnected gas of amino acid residues, nucleic acid bases, and freely moving atoms, which is successively transformed through the many blocks of the network into physically plausible assembly structures. For the loss function to guide parameter optimization, we developed an all-atom version of the frame-aligned point error (FAPE) loss introduced in AF2 by defining coordinate frames for each atom in an arbitrary molecule based on the identities of its bonded neighbors and, as with residue-based FAPE, successively aligning each coordinate frame and computing the coordinate error on the surrounding atoms (Fig. 2A; for greater sensitivity to small-molecule geometry, we upweighted contributions involving atoms; see supplementary methods). In addition to atomic coordinates, the network predicts atom and residue-wise confidence [predicted local distance difference test (pLDDT)] and pairwise confidence [predicted alignment error (PAE)] metrics to enable users to identify high-quality predictions. A full description of the RFAA architecture is provided in the supplementary methods.
    タンパク質や核酸配列とは異なり、分子グラフは順列不変であるため、ネットワークは低分子要素のトークン順序に関係なく同じ予測を行うはずである。 AF2とRF2では、アミノ酸と塩基の配列順序は相対位置エンコーディングで表現されるが、原子についてはそのようなエンコーディングを省略し、ネットワーク注意メカニズムの順列不変性を活用した。 また、座標の更新も変更した： AF2とRFでは、タンパク質残基はCαの座標とN-C-Cリジッドフレームの向き（RFNではP座標とOP1-P-OP2フレームの向き）で表現され、3Dトラックに沿って、ネットワークは各フレームの向きに対する回転更新と各座標に対する並進更新を生成する。 この表現を私たちの生体分子構造予測ネットワークRoseTTAFold All-Atom（RFAA）で一般化するために、重原子座標は3Dトラックに追加され、予測された位置への並進更新のみに基づいて独立して移動します。 このように、入力直後から、全システムはアミノ酸残基、核酸塩基、自由に動く原子の切断された気体として表現され、ネットワークの多くのブロックを介して、物理的にもっともらしいアセンブリ構造に順次変換される。 パラメータの最適化を導く損失関数として、AF2で導入されたフレーム整列点誤差（FAPE）損失の全原子バージョンを開発した。これは、結合した隣接原子の同一性に基づいて任意の分子内の各原子の座標フレームを定義し、残基ベースのFAPEと同様に、各座標フレームを連続的に整列させ、周囲の原子の座標誤差を計算するものである（図2A；低分子形状に対する感度を高めるため、原子が関与する寄与を加重平均した；補足方法参照）。 原子座標に加え、ネットワークは原子および残基ごとの信頼度（predicted local distance difference test (pLDDT)）とペアごとの信頼度（predicted alignment error (PAE)）を予測し、ユーザーが高品質な予測値を識別できるようにします。 RFAAのアーキテクチャの完全な説明は補足方法に記載されています。

# Training RFAA
    PDBのデータを, 溶媒や結晶化時の添加物を除いてcurateした。30%の類似度でクラスター化した。 PDBにある分子以外の分子にも予測を応用するため, cambridgee structural databaseから低分子の構造を取得した。
    グラフ構造から分子の配座を予測した
        ...タンパク質とのドッキング結果ではなく, 分子単独で学習したということ? 配座はどのようなデータ?相対距離?
    また, タンパク質の残基の一部を原子に変えて, 分子として学習した。
    (10,11)に詳しく書かれているらしいが, タンパク質のモノマーでも学習させた。
    事前学習では256トークン, finetuning(RFdiffusionAA?)では375トークンにcrop(...trunk?sampling?)した。
    タンパク質クラスタの10%をtest setにした。
We curated a protein-biomolecule dataset from the PDB that includes protein–small molecule, protein-metal, and covalently modified protein complexes, filtering out common solvents and crystallization additives. After clustering (30% sequence identity) to avoid bias toward overrepresented structures, we obtained 121,800 protein–small molecule structures in 5662 clusters, 112,546 protein-metal complexes in 5324 clusters, and 12,689 structures with covalently modified amino acids in 1099 clusters for training. To help the network learn the general properties of small molecules rather than features specific to the molecules in the PDB, we supplemented the training set with small-molecule crystal structures from the Cambridge Structural Database (12). Each training example is sampled uniformly from the set of organic nonpolymeric molecules, and the network predicts the coordinates for the asymmetric unit given atomic graph information. To further help the network learn about general atomic interactions, we took advantage of the commonalities between atomic interactions within proteins and many of the atomic interactions between proteins and small molecules and augmented the training data by inputting portions of proteins as atoms rather than residues (a process we term atomization). We atomized randomly selected subsets of three to five contiguous residues by deleting the sequence and template features and providing instead atom, bond, and chirality information for the atoms in those residues (an alanine would be replaced by five atom tokens, one for each heavy atom). Because the atoms are still part of the polypeptide chain, we provide the relative position of the atom tokens with respect to the other residue tokens by adding an extra bond token that corresponds to an “atom-to-residue” bond and develop a positional encoding to account for atom-residue bonds (see supplementary methods). To increase prediction accuracy on biological polymers, we trained the network on protein monomer, protein complex, and protein–nucleic acid complex examples, as previously described (10, 11). All examples were cropped to have 256 tokens during the initial stages of training and 375 tokens during fine-tuning. The progress of training was monitored using independent validation sets consisting of 10% of the protein sequence clusters (see table S4).
    タンパク質-低分子複合体、タンパク質-金属複合体、共有結合で修飾されたタンパク質複合体を含むタンパク質-生体分子データセットをPDBからキュレーションし、一般的な溶媒と結晶化添加物を除外した。 過剰発現構造へのバイアスを避けるためにクラスタリング（配列同一性30%）を行った後、5662クラスタに121,800個のタンパク質-低分子構造、5324クラスタに112,546個のタンパク質-金属複合体、1099クラスタに12,689個の共有結合で修飾されたアミノ酸を持つ構造を学習用に得た。 ネットワークがPDBにある分子特有の特徴ではなく、低分子の一般的な特性を学習するのを助けるために、我々はケンブリッジ構造データベース(12)から低分子の結晶構造でトレーニングセットを補足した。 各トレーニング例は、有機非重合体分子のセットから一様にサンプリングされ、ネットワークは原子グラフ情報が与えられた非対称ユニットの座標を予測する。 ネットワークが一般的な原子間相互作用をさらに学習できるように、タンパク質内の原子間相互作用と、タンパク質と低分子間の原子間相互作用の多くに共通性があることを利用し、タンパク質の一部を残基ではなく原子として入力することで学習データを増強した（原子化と呼ぶプロセス）。 ランダムに選択した3～5個の連続した残基のサブセットを原子化し、配列とテンプレートの特徴を削除し、代わりにそれらの残基の原子の原子、結合、キラリティ情報を提供しました（アラニンは5つの原子トークンに置き換えられ、各重原子に1つずつ置き換えられます）。 原子は依然としてポリペプチド鎖の一部であるため、「原子-残基」結合に対応する余分な結合トークンを追加することで、他の残基トークンに対する原子トークンの相対位置を提供し、原子-残基結合を考慮した位置エンコーディングを開発する（補足方法参照）。 生物学的高分子の予測精度を上げるため、タンパク質モノマー、タンパク質複合体、タンパク質-核酸複合体の例でネットワークを学習させた。 全ての例は、トレーニングの初期段階では256個のトークンを持つように切り出され、微調整の際には375個のトークンを持つように切り出された。 トレーニングの進捗は、タンパク質配列クラスターの10%からなる独立した検証セットを用いてモニターした（表S4参照）。

    RFAAは, 様々な分子をモデリングできる。以下ではいくつかの構造モデリングタスクにRFAAを適用した結果を説明する。
Unlike previous protein-only deep-learning architectures (13–15), RFAA can model full biomolecular systems. In the following sections, we describe the performance of RFAA on different structure-modeling tasks. We adopted the philosophy that a single model trained on all available data over all modalities would have the greatest ability to generalize and be more accessible than a series of models specialized for specific problems.
    これまでのタンパク質のみのディープラーニングアーキテクチャ（13-15）とは異なり、RFAAは完全な生体分子システムをモデル化することができる。 以下のセクションでは、様々な構造モデリングタスクにおけるRFAAの性能について述べる。 我々は、全てのモダリティの全ての利用可能なデータに対して訓練された単一のモデルが、特定の問題に特化した一連のモデルよりも、汎化能力が最も高く、より利用しやすいという哲学を採用した。

# Predicting protein–small molecule complexes
    RFAAサーバーをCAMEOに登録した。CAMEOは, 毎週登録されるPDBの新規構造について, その構造を予測するものである。構造には複数のタンパク質, リガンド, 金属イオンを含みうる。AutoDock Vinaは8%でRMSD<2A以下だったのに対し,  RFAAは43%が自信を持って予測され, その77%(全体の32%)がRMSD<2Aだった。失敗としては, 位置は合っていたが方向が間違っていたというパターンが多かった。
To enable blind testing of RFAA prediction performance, we enrolled an RFAA server in the blind Continuous Automated Model EvaluatiOn (CAMEO) ligand-docking evaluation, which carries out predictions on all structures submitted to the PDB each week with each enrolled server and evaluates their performance (16–18). These structures can have multiple protein chains, ligands, and metal ions (for further results on metal ions, see fig. S2). Of the CAMEO targets, 43% are predicted confidently by RFAA (PAE interaction <10), and 77% of those high-confidence structures are quite accurate, with <2-Å ligand root mean square deviation (RMSD) (Fig. 2B). One of the other servers is an implementation of the leading non–deep-learning protein–small molecule docking method AutoDock Vina, developed by the CAMEO organizers, that predicts the protein structure by homology modeling (19–24), runs AutoDock to dock the small molecules, and ranks the poses using the Vina scoring function (9, 19). RFAA consistently outperformed the other servers in CAMEO on protein–small molecule modeling; for example, on cases modeled by both the RFAA and AutoDock Vina servers, RFAA modeled 32% of cases successfully (<2-Å ligand RMSD) compared with 8% for the Vina server (Fig. 2C; the Vina performance by an expert would likely be considerably improved because of the complexities of fully automatic multiple-step modeling pipelines). The most common RFAA failure mode is the placement of small molecules in the correct pockets but not in the correct orientation (fig. S3; for a further exploration of failure modes, see supplementary methods).
    RFAAの予測性能のブラインドテストを可能にするため、我々はRFAAサーバーをCAMEO（Continuous Automated Model EvaluatiOn）リガンド・ドッキング評価（毎週PDBに登録された全構造に対して、登録された各サーバーで予測を行い、その性能を評価する）に登録した(16-18)。 これらの構造は、複数のタンパク質鎖、リガンド、金属イオンを持つことができる（金属イオンの詳細な結果については、図S2を参照）。 CAMEOターゲットのうち、43%はRFAAによって確信を持って予測され（PAE相互作用<10）、これらの高信頼性構造の77%は非常に正確で、リガンドの二乗平均平方根偏差（RMSD）は<2Åであった（図2B）。 他のサーバーの 1 つは、CAMEO のオーガナイザーが開発し た、非ディープラーニングの代表的なタンパク質-小分子ドッ キング手法 AutoDock Vina を実装したもので、相同性モデ リングによってタンパク質構造を予測し（19-24）、AutoDock を実行して小分子をドッキングさせ、Vina スコアリング関数を使用してポーズをランク付けする（9, 19）。 例えば、RFAAとAutoDock Vinaの両サーバーでモデリングしたケースのうち、RFAAは32%のケースのモデリングに成功（<2ÅリガンドRMSD）したのに対し、Vinaサーバーは8%でした（図2C）。完全に自動化されたマルチステップモデリングパイプラインは複雑なため、専門家によるVinaのパフォーマンスはかなり向上すると思われます。 RFAAの最も一般的な失敗モードは、低分子を正しいポケットに配置したが、正しい方向には配置しなかったことである（図S3。）

    CAMEOには他の新装学習モデル(...AF?)が登録されていなかったので, PDBデータをtime-splitして予測した。diffdockは38%で成功した(=RMSD<2A?)のに対し, RFAAは42%で成功した。なお, DiffDockはタンパク質の結晶構造を受け取っているのに対し, RFAAはそれも予測している。タンパク質とリガンドの両方を使う場合, Autodock Vinaなど物理ベースの手法の方がよかった。
        figはS4AではなくS5Aのもの。
        前段落でAutoDockを上回ったと言っていたが, それは(1)構造なし (2)タンパク構造のみ (3) 両方の構造 のどれか? (2)？
There were no other deep-learning docking methods (5, 25–29) enrolled in CAMEO, but we could instead compare performance on a set of PDB structures that were solved after our training-set date cutoff (30) [most earlier deep-learning–based docking tools have focused on the “bound” docking problem, in which the crystal structure of the target (including side chains) are provided and hence are less well suited to CAMEO]. On this benchmark, RFAA predicts 42% of complexes successfully compared with DiffDock, which predicts 38% of complexes successfully (Fig. 2D; RFAA predicts the protein backbone and side chains in addition to the small-molecule dock, whereas DiffDock receives the crystal structure of the protein from the bound complex as input). In cases where both the bound protein structure and the pocket residues are provided, physics-based methods such as AutoDock Vina outperform RFAA (52 versus 42%), which has the much harder task of predicting both the protein backbone and side-chain details and the dock from sequence alone (fig. S4A).
    CAMEOには、他の深層学習ドッキング手法（5, 25-29）は登録されていなかったが、代わりに、トレーニングセットの日付カットオフ(30)以降に解かれたPDB構造のセットで性能を比較することができた［初期の深層学習ベースのドッキングツールのほとんどは、ターゲットの結晶構造（側鎖を含む）が提供されている「バウンド」ドッキング問題に焦点を当てており、したがってCAMEOにはあまり適していない］。 このベンチマークにおいて、RFAAの予測に成功 した複合体は42%であったのに対し、DiffDockの予測に 成功した複合体は38%であった（図2D；RFAAは、低分子ドッ キングに加えて、タンパク質の骨格と側鎖を予測する のに対して、DiffDockは結合した複合体からタンパク質の 結晶構造を入力として受け取る）。 結合したタンパク質の構造とポケット残基の両方が提 供されている場合、AutoDock Vinaのような物理ベースの手法 はRFAAの性能を上回った（52%対42%）。

    別の評価として, 学習データのカットオフ日以降に寄託されたPDB構造の予測を行った。タンパク質・リガンドともに, 学習セットと類似した構造のほうが予測しやすかったが, そうでない構造についてもある程度は予測できた。
To further benchmark the network, we assembled a dataset of recent PDB entries with small molecules bound that were deposited after the cutoff date for our training set and predicted full structure models for all 5421 complexes (1529 protein sequence clusters at 30% sequence identity). Although prediction performance is higher for clusters with overlap with the training set, the network also generates accurate predictions for proteins with low (BLAST e-value >1) sequence similarity to the training set (35 versus 24% success rate, respectively; Fig. 2F). We observed a similar pattern for ligand clusters (across 1310 ligand clusters); although the network makes more accurate predictions for ligands seen in training, it also can make accurate predictions on ligands that are not similar to those in training (<0.5 Tanimoto similarity; 19 versus 14% success rate) (Fig. 2F). In cases where RFAA predicts ligand placement with high confidence and RF2 has high confidence (PAE interaction <10 and pLDDT >0.8, respectively), RFAA makes higher-accuracy protein structure predictions than RF2 (fig. S3A), indicating that training with ligand context can improve overall protein-prediction accuracy. Some examples of shifts predicted by RFAA but not by RF2 include domain movements, subtle backbone movements, and flipping of side-chain rotamers to accommodate the ligand in the pocket (fig. S3, B and C).
    さらにネットワークのベンチマークを行うために、トレーニングセットのカットオフ日以降に寄託された、低分子が結合した最近のPDBエントリーのデータセットをアセンブルし、5421複合体すべて（配列同一性30%の1529タンパク質配列クラスター）について完全構造モデルを予測した。 予測性能はトレーニングセットとオーバーラップするクラスターで高いが、ネットワークはトレーニングセットとの配列類似性が低い（BLAST e-value>1）タンパク質に対しても正確な予測を生成した（成功率はそれぞれ35対24％；図2F）。 リガンドクラスター（1310個のリガンドクラスター全体）についても同様のパターンが観察された。ネットワークはトレーニングで見られるリガンドに対してより正確な予測を行うが、トレーニングのリガンドと類似していないリガンド（<0.5谷本類似度；成功率19対14%）についても正確な予測を行うことができる（図2F）。 RFAAのリガンド配置の信頼度が高く、RF2の信頼度が高い場合（それぞれPAE相互作用＜10、pLDDT＞0.8）、RFAAはRF2よりも高精度のタンパク質構造予測を行い（図S3A）、リガンドコンテキストを用いたトレーニングがタンパク質予測全体の精度を向上させることを示している。 RFAAでは予測されたがRF2では予測されなかったシフトの例としては、ドメインの移動、微妙なバックボーンの移動、ポケット内のリガンドに対応するための側鎖ロータマーの反転などがある（図S3、B、C）。

    図2Dで, 最近解明された複合体構造の適用例を示している。低分子と核酸の両方を含むデータは学習データにはないらしいが, ちゃんと予測できたらしい。
Unlike previous methods, RFAA is able to jointly predict interactions between proteins and multiple nonprotein ligands in a single forward pass. Figure 2D shows three examples of recently solved structures with three or more components for which RFAA predictions had <2-Å ligand RMSD (when the proteins were aligned). There are homologous complexes in the training set, so these are not de novo predictions; however, they demonstrate that RFAA can learn the multicomponent assembly prediction task. Figure 2D, right, shows a prediction for DNA polymerase (31) (PDB ID 7U7W) with a bound DNA, nonhydrolyzable guanine triphosphate and magnesium ion; the network received no examples of higher-order assemblies containing proteins with both small molecules and nucleic acids during training but is likely synthesizing information from multiple related binary complexes that are in the training set.
    これまでの手法とは異なり、RFAAはタンパク質と複数の非タンパク質リガンド間の相互作用を1回のフォワードパスで共同予測することができます。 図2Dは、RFAAの予測値がリガンドのRMSDが2Å未満であった、3つ以上の構成要素を持つ最近解決された構造の3つの例を示している（タンパク質がアラインメントされた場合）。 トレーニングセットには相同複合体があるので、これらはde novo予測ではありませんが、RFAAが多成分アセンブリ予測タスクを学習できることを示しています。 図2D右は、DNA、非加水分解性グアニン三リン酸、マグネシウムイオンが結合したDNAポリメラーゼ(31)(PDB ID 7U7W)の予測を示しています。このネットワークは、トレーニング中に、低分子と核酸の両方を持つタンパク質を含む高次アセンブリーの例を受け取っていませんが、トレーニングセットに含まれる複数の関連バイナリー複合体から情報を合成していると考えられます。

    (S7)タンパク質と, それと結合することが知られている化合物と, それと最も谷本系数が高い化合物について複合体構造を予測したところ, 75.1%において, リガンドの方が(複合体構造から計算される?)PAE相互作用が低かった。このタスクについて直接最適化(=fine tuning?)すればさらに精度が向上する可能性がある。
To assess whether the network can distinguish compounds known to bind from related compounds, we compared protein–small molecule complex predictions for the PoseBusters dataset for the compound known to bind and decoy molecules, including small molecules, with the highest Tanimoto similarity in the dataset. In 75.1% of cases, the PAE interaction metric of the “decoy” complex was higher (indicating lower confidence) than the native complex (fig. S7). Direct optimization on this discrimination task would likely further improve performance.
    このネットワークが結合することが知られている化合物と関連化合物とを区別できるかどうかを評価するために、PoseBustersデータセットについて、結合することが知られている化合物と、データセット中で最も谷本類似度が高い低分子を含むおとり分子とのタンパク質-低分子複合体予測を比較した。 75.1%のケースで、「おとり」複合体のPAE相互作用指標は、ネイティブ複合体よりも高かった（信頼度が低いことを示す）（図S7）。 この識別タスクで直接最適化すれば、パフォーマンスがさらに向上する可能性が高い。

    (2Gの説明)(正解の決勝構造について?)計算した結合エネルギーが低いほど, 正確に予測できることがわかった。これは, RFAAが詳細な相互作用に基づいて予測を行っていることを示している。
To determine the extent to which the network is reasoning over the detailed structure of protein–small molecule interactions, we investigated the correlation between prediction accuracy and the interaction energy computed by a molecular force field. We found that predictions for protein–small molecule complexes in our recent PDB set with lower computed binding energies (Rosetta ΔG) (32, 33) were more accurate (Fig. 2G; 50, 25, and 22% success rates for <−30, −30 to 0, and >0 Rosetta energy units, respectively), which suggests that the network considers the detailed interactions between the protein and small molecule (although reasoning over these interactions very differently than human-designed force fields).
   タンパク質-低分子相互作用の詳細な構造に対してネットワークがどの程度推論されているかを調べるために、予測精度と分子力場で計算された相互作用エネルギーとの相関を調べた。 その結果、我々が最近作成したPDBセットのタンパク質-低分子複合体の予測では、計算された結合エネルギー（Rosetta ΔG）（32,33）が低いほど精度が高いことがわかった（図2G；＜30、-30～0、＞0のRosettaエネルギー単位に対して、それぞれ50、25、22％の成功率）。これは、ネットワークがタンパク質と低分子間の詳細な相互作用を考慮していることを示唆している（ただし、これらの相互作用に関する推論は、人間が設計した力場とは全く異なる）。 

# Predicting structures of covalent modifications to proteins
    生体内のシグナル伝達など様々な反応には共有結合が関与している。RFAAでは, 化学部分を原子として(=原子単位で?)扱うことでモデル化できる。
Many essential protein functions, such as receptor signaling, immune evasion, and enzyme activity, involve covalent modifications of amino acid side chains with sugars, phosphates, lipids, and other molecules (34–37). RFAA models such modifications by treating the residue and chemical moiety as atoms (with the corresponding covalent bond to the atom token in the residue) and the rest of the protein structure as residues (Fig. 3A). Unnatural amino acids can be modeled in the same way.
    受容体シグナル伝達、免疫回避、酵素活性など、多くの必須タンパク質機能には、アミノ酸側鎖の糖、リン酸、脂質、その他の分子との共有結合による修飾が関与している(34-37)。 RFAAはこのような修飾を、残基と化学部分を原子（残基の原子トークンに対応する共有結合を持つ）として扱い、タンパク質構造の残りの部分を残基として扱うことでモデル化する（図3A）。 非天然アミノ酸も同じようにモデル化できる。

    低分子との共有結合の構造予測を, 最近のデータで評価した。タンパク質をアラインメントしたときの低分子の位置予測は, 46%でRMSD<2.5A以下だった(なぜ2Aでないのか?)。60%はPAE<10, つまり自信を持って予測され, その63%は正確だった(3B)。 (3C)学習データとの相同性が高い方が正確だったが, 相同性が低くてもそれなりに予測された。(3C, 3D, 3E)共有結合した補酵素・薬剤は, 中央値RMSD 0.99A, 2.8Aで予測された。
We benchmarked the performance of RFAA on covalent modification structure prediction on 931 recent entries in the PDB (after May 2020) and found that the network made accurate predictions (modification RMSD <2.5 Å) in 46% of cases (modification RMSD is the RMSD of the modified residue and chemical modification when the rest of the protein is aligned). As in the protein–small molecule complex case, confident predictions tend to be more accurate: 60% of structures are predicted with high confidence (PAE interaction <10), and 63% of those predictions are accurate (<2.5-Å modification RMSD) (Fig. 3B). Although the network makes slightly more-accurate predictions on cases with sequence similarity (>25% identity) to proteins in the training set, there are still many cases (27.5%) that do not have sequence overlap to the training set that are predicted with high accuracy (Fig. 3C). RFAA models interactions with covalently bound cofactors and covalently bound drugs with median RMSDs of 0.99 and 2.8 Å, respectively (Fig. 3, D and E).
    共有結合修飾構造予測におけるRFAAの性能を、PDBに最近登録された931のエントリー（2020年5月以降）でベンチマークしたところ、46％のケースで正確な予測（修飾RMSD＜2.5Å）を行うことがわかりました（修飾RMSDとは、タンパク質の残りの部分をアラインメントしたときの、修飾残基と化学修飾のRMSDです）。タンパク質-低分子複合体の場合と同様に、確信のある予測はより正確である傾向があります： 構造の60%は高い信頼性（PAE相互作用<10）で予測され、それらの予測の63%は正確（<2.5-Å修飾RMSD）である（図3B）。このネットワークは、トレーニングセットのタンパク質と配列が類似している（25%以上の同一性）ケースについて、わずかに精度の高い予測を行うが、トレーニングセットと配列が重複していないケース（27.5%）もまだ多く、高い精度で予測される（図3C）。RFAAは、共有結合した補酵素や共有結合した薬剤との相互作用を、それぞれRMSD中央値0.99Åと2.8Åでモデル化した（図3、DとE）。

    糖鎖の構造予測は治療・ワクチン・診断などに使われている。
    (3D)RFAAは糖鎖も中央RMSD3.2Aで予測できる。
    (3F)なんとかかんとかとかいう糖鎖は, 学習データとの相同性が低いが, 正確に予測できた。
    (S8C)予測は実験的な密度マップ(..?)と一致していることから,  RFAAは単に構造生成プログラムが糖鎖をどうモデリングするかを学習しているわけではないことがわかる
        ...構造生成プログラムの結果を学習に使ったりしてたっけ?
    (S8)他にも, 学習データと配列が離れたデータや, 7糖鎖の糖鎖についても正確に予測できた。
    
Prediction of glycan structure has applications in therapeutics, vaccines, and diagnostics (38–40). RFAA can accurately model carbohydrate groups introduced by glycosylation with a median RMSD over our test set of 3.2 Å (Fig. 3D). RFAA successfully predicts glycan conformations on the N-acetylglucosamine-1-phosphotransferase (GNPT) gamma subunit (PDB ID 7S69) and human sperm TMEM95 ectodomain (PDB ID 7UX0), which have low sequence homology (<30%) to the RFAA training set (Fig. 3F) and have multiple monosaccharides and different branching patterns (41, 42). RFAA is not simply learning how structure-building programs model glycans because the predictions match the experimental density maps (fig. S8C). The network was able to make accurate predictions of glycan interactions even when the sequences were distant from the sequences in the training set and on glycans with chains of up to seven monosaccharides (fig. S8).
    糖鎖構造の予測は、治療、ワクチン、診断に応用されている(38-40)。RFAAはグリコシル化によって導入された糖鎖基を正確にモデル化することができ、テストセットにおけるRMSDの中央値は3.2Åであった（図3D）。RFAAはN-アセチルグルコサミン-1-ホスホトランスフェラーゼ（GNPT）ガンマサブユニット（PDB ID 7S69）とヒト精子TMEM95エクトドメイン（PDB ID 7UX0）の糖鎖コンフォメーション予測に成功している。これらはRFAAのトレーニングセットと配列相同性が低く（<30%）、複数の単糖と異なる分岐パターンを持っている（図3F）(41, 42)。RFAAの予測値は実験的密度マップと一致することから（図S8C）、RFAAは構造構築プログラムがどのように糖鎖をモデル化するかを単に学習しているわけではない。このネットワークは、配列がトレーニングセットの配列と離れていても、また7糖までの単糖鎖を持つ糖鎖でも、糖鎖相互作用の正確な予測を行うことができた（図S8）。

    共有結合の予測モデルは他にないため, 比較することは難しい。本モデルは生物学に応用できるだろう。
It is difficult to compare RFAA with other methods because, to our knowledge, previous deep learning–based tools do not model covalent modifications to proteins. Accurate and robust modeling of covalent modifications in predicted structures should contribute to the understanding of biological function and mechanism.
    我々の知る限り、これまでの深層学習ベースのツールはタンパク質の共有結合修飾をモデル化していないため、RFAAの他の手法との比較は難しい。予測された構造における共有結合修飾の正確でロバストなモデリングは、生物学的機能とメカニズムの理解に貢献するはずである。

# De novo small-molecule binder design
    低分子と結合するタンパク質を設計しようという話においては, 多くの場合既存のタンパク質や専門家が設計したタンパク質についてDockingスクリーニングすることが多かった。拡散モデルは, タンパク質と結合するタンパク質を設計でき, また何らかの性質を持つように条件づけることも可能である。しかし, 現在の設計手法は低分子とタンパク質の相互作用をモデリングしておらず, 低分子と結合するタンパク質を設計することはできない(RFdiffusionでは, なんとなく設計することはできるが, 厳密に相互作用を考慮して設計することはできない)。低分子と結合するタンパク質を設計する手法は有用だろう。
        ...そもそも, タンパク質に結合するリガンドを設計する話がほとんどだと思うが, リガンドに結合するタンパク質を設計しようという話はどれくらいあるのか。
            ...それが43, 44ということか。
Previous work on the design of small-molecule binding proteins has involved docking molecules into large sets of native or expert-curated protein scaffold structures (43, 44). Diffusion-based methods can generate proteins in the context of a protein target that bind with considerable affinity and specificity (45) and can be trained to explicitly condition on structural features (46). However, present deep learning–based generative approaches do not explicitly model protein-ligand interactions, so they are not directly applicable to the small-molecular-binder design problem [in RFdiffusion, a heuristic attractive-repulsive potential encouraged the formation of pockets with shape complementarity to a target molecule, but the approach was unable to model the details of protein–small molecule interactions (45)]. A general method that can generate protein structures around small molecules and other nonprotein targets to maximize favorable interactions could be broadly useful.
    低分子結合タンパク質の設計に関するこれまでの研究では、分子をネイティブまたは専門家がキュレーションしたタンパク質の足場構造の大規模なセットにドッキングしてきた(43, 44)。拡散に基づく手法は、かなりの親和性と特異性で結合するタンパク質を標的タンパク質のコンテキストで生成することができ（45）、構造的特徴を明示的に条件付けるように訓練することができる（46）。しかし、現在の深層学習ベースの生成的アプローチは、タンパク質-リガンド相互作用を明示的にモデル化していないため、低分子結合体設計問題には直接適用できない［RFdiffusionでは、ヒューリスティックな魅力的反発ポテンシャルが標的分子と形状相補性を持つポケットの形成を促したが、このアプローチはタンパク質-低分子相互作用の詳細をモデル化できなかった(45)］。低分子や他の非タンパク質標的の周囲に、好ましい相互作用を最大化するようなタンパク質構造を生成できる一般的な方法は、広く有用であろう。

    RFAAにより非タンパク質と結合するタンパク質の設計が可能だろうと考えた。構造予測モデルの重みを初期値として, タンパク質とリガンドに座標のガウスノイズ?と回転多様体上のブラウン運動?ノイズを加えたものから, 元の構造を予測させた。
We reasoned that RFAA could enable protein design in the context of nonprotein biomolecules after fine-tuning on structure denoising. We developed a diffusion model, RFdiffusion All-Atom (RFdiffusionAA), by training a denoising diffusion probabilistic model initialized with the RFAA structure-prediction weights to denoise corrupted protein structures conditioned on the small molecule and other biomolecular context (Fig. 4A). Input structures from the protein–small molecule dataset described above were noised through progressive addition of 3D Gaussian noise to the Cα coordinates and Brownian motion on the manifold of rotations, and the model was trained to remove this noise. In contrast to training for the unconditional generation problem and incorporating conditional information through forms of guidance (47, 48), this training procedure results in an explicitly conditional model that learns the distribution of proteins conditioned on biomolecular substructure. To enable the inclusion of specific protein functional motifs when desired, we also trained the network to scaffold a variety of discontiguous protein motifs both in the presence and absence of small molecules. To generate proteins, we initialized a Gaussian distribution of residue frames with randomized rotations around a fixed small-molecule motif; at each denoising step t, we predicted the fully denoised X0 state and then updated all residue coordinates and orientations by taking a step toward this conformation while adding noise to match the distribution for Xt−1. As with RFdiffusion, we investigated the use of auxiliary potentials to influence trajectories to make more contacts between small molecules and binders but found these to be unnecessary (see fig. S10C).
    われわれは、RFAAを用いることで、非タンパク質生体分子を対象としたタンパク質設計が可能になると考えた。RFAAの構造予測重みで初期化されたノイズ除去拡散確率モデルを、低分子および他の生体分子のコンテキストを条件として、破損したタンパク質構造をノイズ除去するようにトレーニングすることで、拡散モデルRFdiffusion All-Atom（RFdiffusionAA）を開発した（図4A）。上述したタンパク質-低分子データセットからの入力構造は、Cα座標への3次元ガウスノイズと回転多様体上のブラウン運動の漸進的付加によってノイズ化され、モデルはこのノイズを除去するように訓練された。無条件生成問題のためのトレーニングや、ガイダンスの形を通して条件情報を取り入れること（47, 48）とは対照的に、このトレーニング手順は、生体分子部分構造に条件付けられたタンパク質の分布を学習する、明示的な条件付きモデルをもたらす。また、必要に応じて特定のタンパク質機能モチーフを組み込むことができるように、小分子の存在下と非存在下の両方で、様々な不連続なタンパク質モチーフを足場とするようにネットワークを訓練した。タンパク質を生成するために、固定された低分子モチーフの周りのランダムな回転を持つ残基フレームのガウス分布を初期化した。それぞれのノイズ除去ステップtで、完全にノイズ除去されたX0状態を予測し、Xt-1の分布と一致するようにノイズを加えながら、このコンフォメーションに向かって一歩ずつ進むことによって、すべての残基座標と向きを更新した。RFdiffusionと同様に、低分子と結合体の接触を増やすために、軌道に影響を与える補助ポテンシャルの使用を検討したが、不要であることがわかった（図S10C参照）。

     RFDiffusionAAでは, まずバックボーンを生成した後, LignadMPNNによってアミノ酸の種類を決定した(?)。(評価指標として?)Rosetta GALigandDockによって界面(の相互作用の強さ?)を評価し, RF2によって配列が設計された構造をちゃんとコードしているか(=配列からAFで予測した構造が, 骨格から作ったものと一致しているかということ?)を評価した。
        ...LigandMPNNの段階で, AF2を使って設計したものがちゃんとタンパク質をコードするか確かめればよいのでは?
    (S10C) AAでないRFDiffusionnと比べ, 結合エネルギー(=Rosetta GALigandDockで計算したやつ?)がはるかに低かった。
    (S10C) RFAAは, 4つのパターン全てで(AF2の構造予測で?)バックボーンRMSD<2Aになった。
        ...AF2はリガンドをモデリングできないはずだが, いいのか。
    (S11, S12)4つの低分子について, 元々の結合タンパク質とは異なる多様な構造を生成した。
We evaluated RFdiffusionAA in silico by generating protein structures in the context of four diverse small molecules. Starting from random residue distributions surrounding each of the small molecules, iterative denoising yielded coherent protein backbones with pockets complementary to the small-molecule target. After sequence design using LigandMPNN (49, 50), Rosetta GALigandDock (32) energy calculations were used to evaluate the protein–small molecule interface and AF2 predictions to evaluate the extent to which the sequence encodes the designed structure (45, 51). The computed binding energies of RFdiffusionAA designs are far better (p < 1.56 × 10−12) than those obtained using a heuristic attractive-repulsive potential with protein-only RFdiffusion (fig. S10C). RFdiffusionAA generated backbones that could be repredicted with AF2 with backbone RMSD <2 Å for all four design cases (fig. S10C). For each small molecule, RFdiffusionAA generates diverse protein structural solutions to the binding problem that differ from native binders to these ligands (figs. S11 and S12).
    我々は、RFdiffusionAAを4種類の低分子化合物を用いてタンパク質構造を生成し、シリコで評価した。それぞれの低分子を取り囲むランダムな残基分布から出発し、反復ノイズ除去により、低分子ターゲットに相補的なポケットを持つコヒーレントなタンパク質バックボーンが得られた。LigandMPNN (49, 50)を用いて配列を設計した後、Rosetta GALigandDock (32)のエネルギー計算を用いてタンパク質と低分子の界面を評価し、AF2予測を用いて配列が設計した構造をどの程度コードしているかを評価した(45, 51)。計算されたRFdiffusionAA設計の結合エネルギーは、タンパク質のみのRFdiffusionでヒューリスティックな魅力的反発ポテンシャルを用いて得られたものよりもはるかに優れている（p < 1.56 × 10-12）（図S10C）。RFdiffusionAAは、4つのデザインケースすべてにおいて、バックボーンRMSD <2ÅでAF2で再現できるバックボーンを生成した（図S10C）。それぞれの低分子について、RFdiffusionAAは、これらのリガンドに対するネイティブの結合体とは異なる、結合問題に対する多様なタンパク質構造解を生成した（図S11とS12）。

# Experimental characterization of designed binders
    (図4)RFAAの性能を実験的に評価するために, タンパク質モチーフを含まない分子, 1つは1残基(=1アミノ酸?)を持つ分子, 4残基を持つ分子について, それと結合するタンパク質を設計し, 大腸菌で生産し, 活性を評価した。
To experimentally evaluate RFdiffusionAA across a range of design scenarios, we designed binders for three diverse small molecules: one with no protein motif included in the design parameters, one with a single-residue protein motif, and one with a four-residue protein motif (Fig. 4). We produced the proteins in Escherichia coli and measured ligand binding experimentally.
    RFdiffusionAAを様々な設計シナリオで実験的に評価するために、3つの多様な低分子に対する結合体を設計した。1つは設計パラメーターにタンパク質モチーフを含まないもの、1つは1残基のタンパク質モチーフを持つもの、もう1つは4残基のタンパク質モチーフを持つものである（図4）。これらのタンパク質を大腸菌で生産し、リガンド結合を実験的に測定した。

    ジゴキシゲニンは, ジゴキシンのアグリコン(化合物に糖が付加したものを配糖体といい, そのグリコシル基(=糖部分?)が水素に置換したものをアグリコンという)で, 心臓病の治療に使われるが, 治療域(=毒性なく治療効果を発揮できる濃度範囲?)が狭い。ジゴキシゲニン結合タンパク質が設計できれば, 毒性の軽減に役立つ可能性がある。これまでは, (人力ベースの手法?)に基づいた手法が多かった。
    (4A)私たちは骨格やリガンド界面(=どこでジゴキシゲニンと接するかということ?)を仮定せず, RFAdiffusionで結合タンパクを設計した。
    (骨格を設計した後の?)配列はLigandMPNNと Rosetta FastRelaxを用いてっ習得し, AF2予測やRosettaメトリクスとの整合性に基づき4416配列を選択した(補方法)。
    (4B)最も親和性の高いタンパク質は乖離定数が高く, (複合体構造が?単体のタンパク質で?)(実験的に)95度まで安定だった
        ... 4416もデザインしたのか。。。現実の実験プロトコルとしてはもう少し少ない数で進めるだろうから, それと同じ条件でやってほしかった。
Digoxigenin (DIG) is the aglycone of digoxin, a small molecule used to treat heart diseases with a narrow therapeutic window (52), and digoxigenin-binding proteins could help reduce toxicity (53). Previous attempts to design digoxigenin-binding proteins relied on protein scaffolds with experimentally determined structures and prespecified binding pockets and interacting motifs (54). We used RFdiffusionAA to design digoxigenin-binding backbones without any prior assumption about the protein-ligand interface or backbone structure (Fig. 4A). Sequences were obtained using LigandMPNN and Rosetta FastRelax (55), and 4416 designs were selected based on consistency with AF2 predictions and Rosetta metrics (see supplementary methods). Experimental characterization identified several DIG-binding proteins (figs. S29 and S30 and supplementary methods); the highest-affinity binder has a 343-nM dissociation constant (Kd) for free digoxigenin (as measured by isothermal titration calorimetry; Fig. 4B) and is stable at temperatures up to 95°C.
    ジゴキシゲニン（DIG）はジゴキシンのアグリコンであり、治療域の狭い心臓病の治療に使われる低分子化合物である(52)。ジゴキシゲニン結合タンパク質は、毒性の軽減に役立つ可能性がある(53)。ジゴキシゲニン結合タンパク質を設計するこれまでの試みは、実験的に決定された構造と、あらかじめ指定された結合ポケットと相互作用モチーフを持つタンパク質スカフォールドに依存していた(54)。われわれはRFdiffusionAAを用いて、タンパク質-リガンド界面や骨格構造を事前に仮定することなく、ジゴキシゲニン結合性骨格を設計した（図4A）。配列はLigandMPNNとRosetta FastRelax(55)を用いて取得し、AF2予測やRosettaメトリクスとの整合性に基づいて4416のデザインを選択した（補足方法参照）。最も親和性の高い結合タンパク質は、遊離ジゴキシゲニンに対する解離定数（Kd）が343nM（等温滴定熱量測定による）で、95℃まで安定である（図4B）。

    ヘムはいろんな反応に使われており, それと結合するタンパク質が設計で切れば有用である。私たちはあえてヘムの周りにダミー原子をおいた上でその周りにアミノ酸を拡散さっせ, 廃位できるようにしたヘムいりタンパク質を設計した。(バックボーンに対する側鎖の配列から?)AF2の予測信頼度(pLDDT), バックボーンに対する(AFか何かで予測した?) RMSD, デザインに対するシステインロータマー(=ヘム?ダミー原子?)のRMSDに基づき168(のアミノ酸配列?)を選択し, そのうち135が大腸菌で発現し, 90がCysと結合するヘムと同じスペクトルを示した(... 既存のそういうタンパク質と同じということ?ヘムと結合するという性質から計算されるスペクトルがあり, それを満たしたということ?)。そのうち40を精査したところ(どのような基準で選んだ?), 33は単量体だった。以下いくつかについて性質を示している。図4
Heme is a cofactor for a wide range of oxidation reactions and oxygen transport (cytochrome P450 and hemoglobin are two notable examples), with catalytic function enabled by pentacoordinate iron binding and an open substrate pocket (56, 57). Designed heme-binding proteins with these features have considerable potential as a platform for the development of new enzymes (58). We diffused proteins around heme with the central iron coordinated by a cysteine and a placeholder molecule just above the porphyrin ring to keep the axial heme binding site open for potential substrate molecules. Of 168 designs selected based on AF2-predicted confidence (pLDDT), backbone RMSD to design, and RMSD of the predicted cysteine rotamer to the design, 135 were well expressed in E. coli, and 90 had ultraviolet-visible (UV-Vis) spectra consistent with Cys-bound heme (as judged by the Soret maximum wavelength after in vitro heme loading) (59).We further purified 40 of the designs and found that 33 were monomeric and retained heme binding through size exclusion chromatography. For 26 of the designs, we mutated the putative heme-coordinating cysteine residue to alanine, which led to a notable change in the Soret features in all cases (Fig. 4 and figs. S13 to S16). Twenty designs exhibit high thermostability, retaining their heme binding at temperatures above 85°C, and do not unfold at temperatures up to 95°C (Fig. 4C and figs. S13 to S16). We solved the crystal structure of heme-loaded design HEM_3.C9 to 1.8-Å resolution (PDB ID 8VC8) and found it to closely match that of the design model (0.86-Å Cα RMSD). The crystal structure verifies that heme is bound through Cys ligation in a pentacoordinate fashion with an open distal pocket (in agreement with spectroscopic data) and is further held in place with hydrogen bonds to two arginines, as designed (fig. S17).
    ヘムは広範な酸化反応や酸素輸送の補酵素であり（シトクロムP450とヘモグロビンが2つの顕著な例である）、五配位鉄結合と開いた基質ポケットによって触媒機能を可能にしている(56, 57)。このような特徴を持つヘム結合タンパク質を設計すれば、新しい酵素を開発するためのプラットフォームとして大きな可能性がある(58)。われわれは、中心鉄がシステインによって配位され、ポルフィリン環のすぐ上にプレースホルダー分子を持つヘム周りのタンパク質を拡散させ、軸方向のヘム結合部位を潜在的な基質分子に対して開いておくようにした。AF2予測信頼度（pLDDT）、デザインに対するバックボーンRMSD、およびデザインに対する予測システインロータマーのRMSDに基づいて選択された168のデザインのうち、135は大腸菌でよく発現し、90はCys結合ヘムと一致する紫外可視（UV-Vis）スペクトルを有していた（in vitroヘム負荷後のソレト最大波長で判断）(59)。さらに40のデザインを精製し、33はサイズ排除クロマトグラフィーによって単量体であり、ヘム結合を保持していることを見出した。このうち26のデザインについて、ヘム配位システイン残基をアラニンに変異させたところ、すべてのケースでソレトの特徴が顕著に変化した（図4、図S13からS16）。20のデザインは高い耐熱性を示し、85℃以上の温度でヘム結合を保持し、95℃までの温度では展開しない（図4Cおよび図S13からS16）。我々は、ヘム担持デザインHEM_3.C9の結晶構造を1.8Åの分解能で解き（PDB ID 8VC8）、デザインモデルと密接に一致することを見出した（0.86Å Cα RMSD）。この結晶構造から、ヘムはCysのライゲーションにより5配位で結合し、遠位ポケットが開いていることが確認され（分光学的データと一致）、さらに設計通り2つのアルギニンへの水素結合で保持されていることがわかった（図S17）。



    ビリンはシサノバクテリアとかにあるタンパク質である(...何か重要なのか?)。本研究ではビリンの特定のタンパク質に結合するようにタンパク質を設計した。結合能を色が変わるかどうかでスクリーニングし, 94の中から9つの活性のあるタンパク質を見つけた(...少なくない?残りはどうしているのか)。そして活性を評価した。
Bilins are brilliantly colored pigments that play important roles across diverse biological kingdoms. When bilins are constrained by protein scaffolds, such as phycobiliproteins in the megadalton phycobilisome antenna complexes of cyanobacteria and some algae (60), their absorption features narrow, their extinction coefficients increase, and their fluorescence is markedly enhanced. We sampled diffusion trajectories conditioned on the structure of a bilin molecule attached to a four-residue peptide motif recognized by the CpcEF bilin lyase (61, 62). We evaluated 94 designs with a whole-cell screen using phycoerythrobilin (PEB) as the chromophore and, on the basis of pigmentation of fluorescence, identified nine proteins dissimilar to each other and to CpcA (fig. S18A) that bind bilin (a 9.6% hit rate). We purified three designs—BIL_C11, BIL_H4, and BIL_F9—with absorption maxima at 573, 605, and 607 nm, respectively, compared with 557 nm for the CpcA-PEB [Fig. 4D and fig. S8B; the extent of red shifting correlates with computed electrostatic potential around the chromophore (fig. S19)]. Conformationally restricted bilins typically display higher fluorescence yields; absolute fluorescent yields for the BIL_C11, BIL_H4, and BIL_F9 designs are 38, 11, and 25%, respectively, based on an earlier determination of the absolute ﬂuorescence quantum yield for CpcA-PEB of 67% (63) (fig. S18C). These values are much higher than those obtained previously with maquette scaffolds [fluorescence quantum yield (FΦ) values of 2 to 3%], which displayed limited bilin incorporation and less pronounced spectral enhancements (64). The strong coloration, absorption, and emission for these designs were absent from control E. coli strains that synthesize only (i) the PEB bilin and the CpcE/F lyase or (ii) PEB, CpcE/F, and maltose-binding protein (fig. S20). The 34- and 30-nm ranges in absorption and emission, respectively, covered by just one design round using a single chromophore raises the exciting prospect of tailoring the spectral profiles of designed biliproteins by manipulating the conformational flexibility of the bilin and the protein microenvironment. De novo–designed antenna complexes could harvest light over a wider range of the UV-Vis spectrum to enhance photosynthetic energy capture and conversion (65), and fluorescent reporter probes with tunable excitation and emission maxima would be useful biochemical tools.
    ビリンは、様々な生物界で重要な役割を果たす鮮やかな色の色素である。シアノバクテリアやいくつかの藻類のメガダルトンフィコビリソームアンテナ複合体のフィコビリタンパク質(60)のように、ビリンがタンパク質の足場によって拘束されると、その吸収特性は狭くなり、消光係数は増加し、蛍光は著しく増強される。我々は、CpcEFビリンリアーゼ(61, 62)によって認識される4残基のペプチドモチーフに結合したビリン分子の構造を条件として拡散軌道をサンプリングした。発色団としてフィコエリスロビリン（PEB）を用いた全細胞スクリーニングで94のデザインを評価し、蛍光の色素沈着に基づいて、ビリンと結合する互いに異種のタンパク質とCpcA（図S18A）を9つ同定した（ヒット率9.6%）。BIL_C11、BIL_H4、BIL_F9の3種類を精製したところ、それぞれ573nm、605nm、607nmに吸収極大を示し、CpcA-PEBは557nmであった[Fig. レッドシフトの程度は、計算された発色団周辺の静電ポテンシャルと相関する（図S19）]。BIL_C11、BIL_H4、およびBIL_F9設計の絶対蛍光収率は、CpcA-PEBの絶対蛍光量子収率67％（63）の以前の決定に基づいて、それぞれ38、11、および25％である（図S18C）。これらの値は、以前マケット足場で得られた値［蛍光量子収率（FΦ）2〜3％］よりもはるかに高く、ビリンの取り込みが制限され、スペクトルの増強もあまり顕著ではなかった（64）。これらのデザインにおける強い発色、吸収、および発光は、(i)PEBビリンとCpcE/Fリアーゼ、または(ii)PEB、CpcE/F、およびマルトース結合タンパク質のみを合成する対照大腸菌株には見られなかった（図S20）。単一の発色団を用いたたった1回の設計ラウンドで、吸収と発光のそれぞれ34nmと30nmの範囲をカバーできたことから、ビリンとタンパク質の微小環境のコンフォメーションの柔軟性を操作することによって、設計された二重タンパク質のスペクトルプロファイルを調整できるというエキサイティングな見通しが得られた。新たに設計されたアンテナ複合体は、光合成のエネルギー捕獲と変換を促進するために、紫外-可視スペクトルのより広い範囲にわたって光を利用することができる(65)。


    設計されたタンパク質の配列は, 学習データ中のどのタンパク質との類似性(TMスコアというので計算している)も低かった。
The experimental validation of digoxigenin-, heme-, and bilin-binding proteins demonstrates that RFdiffusionAA can readily generate proteins with custom binding pockets for diverse small molecules. Unlike prior methods that rely on redesigning existing scaffolds, RFdiffusionAA builds proteins from scratch around the target compound, resulting in high shape complementarity in the binding pockets and reducing the need for expert knowledge. The ability of RFdiffusionAA to generalize is highlighted by the sequence and structural dissimilarity between the designs and proteins in the PDB that bind related molecules (Tanimoto similarity >0.5); the most similar protein in the PDB that binds a related molecule has a template modeling score (TM score) of 0.59 for the highest-affinity digoxigenin binder, less than 0.62 for all the characterized heme binders, and less than 0.52 for the bilin binders (fig. S21). In all cases, there is no detectable sequence similarity to any known protein.
    ジゴキシゲニン、ヘム、ビリン結合タンパク質の実験的検証は、RFdiffusionAAが多様な低分子に対するカスタム結合ポケットを持つタンパク質を容易に生成できることを示している。既存のスキャフォールドの再設計に依存する従来の手法とは異なり、RFdiffusionAAは標的化合物の周りにタンパク質をゼロから構築するため、結合ポケットの形状相補性が高く、専門的知識の必要性が減少します。RFdiffusionAAの汎化能力は、設計とPDB中の関連分子を結合するタンパク質（谷本類似度>0.5）との間の配列および構造の非類似性によって強調される。関連分子を結合するPDB中の最も類似したタンパク質は、最も親和性の高いジゴキシゲニンバインダーのテンプレートモデリングスコア（TMスコア）が0.59、すべての特徴付けられたヘムバインダーのTMスコアが0.62未満、ビリンバインダーのTMスコアが0.52未満である（図S21）。すべての場合において、既知のタンパク質との検出可能な配列類似性はない。

# Discussion
     RFAAにより, タンパク質と低分子の両方をモデリングできることが示された。タンパク質と低分子の共有結合を, タンパク質単独系においてディープラーニングモデルがタッっせいしているのと同程度の性能を達成するには, よりデータセットやモデルの改善が必要だろう。低分子のモデリングは, タンパク質単独の構造の予測精度を下げるものではない。
RFAA demonstrates that a single neural network can be trained to accurately model a wide range of general biomolecular assemblies that contain a wide diversity of nonprotein components. RFAA can make high-accuracy predictions on protein–small molecule complexes, with 32% of CAMEO targets predicted under 2-Å RMSD, and for covalent modifications to proteins, predicting 46% of recently solved covalent modifications under 2.5-Å RMSD; it can also generate accurate models for complexes of proteins with two or more nonprotein molecules (small molecules, metals, nucleic acids, etc.). Training on more-extensive datasets and/or architectural improvements will likely be necessary to generate consistently accurate predictions for protein–small molecule complexes that are on par with the accuracy of predictions that deep networks can achieve on protein systems alone. The new prediction capabilities do not come at the expense of performance on the classic protein structure prediction problem: RFAA achieves a protein-structure prediction accuracy similar to that of AF2 [median global distance test (GDT) of 85 versus 86] and a protein–nucleic acid complex accuracy similar to that of RFNA (median allatom-LDDT of 0.74 versus 0.78) (fig. S22).
    RFAAは、多様な非タンパク質成分を含む一般的な生体分子集合体を、単一のニューラルネットワークで高精度にモデル化できることを実証しています。RFAAは、タンパク質と低分子の複合体について高精度の予測を行うことができ、CAMEOターゲットの32%を2Å RMSD以下で予測し、タンパク質の共有結合修飾については、最近解決された共有結合修飾の46%を2.5Å RMSD以下で予測しています。また、タンパク質と2つ以上の非タンパク質分子（低分子、金属、核酸など）との複合体についても正確なモデルを生成することができます。タンパク質-低分子複合体について、ディープネットワークがタンパク質系単独で達成できる予測精度に匹敵する、一貫して正確な予測を行うには、より広範なデータセットでのトレーニングや、アーキテクチャの改良が必要になると思われる。新しい予測能力は、古典的なタンパク質構造予測問題の性能を犠牲にするものではない： RFAAは、AF2と同程度のタンパク質構造予測精度（グローバル距離検定（GDT）の中央値85対86）と、RFNAと同程度のタンパク質-核酸複合体予測精度（allatom-LDDTの中央値0.74対0.78）を達成した（図S22）。

    RFAAはタンパク質-低分子間の詳細な相互作用を学習していることが示唆された。 第一に, (2F,3C)学習データとかなり異なるタンパク質・リガンドに対しても構造を予測でき, (2G)Rosettaで結合の親和性が高いと予測された構造に対してはさらに精度が高かった。第二に, RFDiffusionAAで設計した ビリン, ヘム, ジゴキシゲニンと結合するタンパク質は,  PDBにある同様のタンパク質とは全く異なる構造を示した。RFAAは, 多成分生体分子集合体のモデリングや, 低分子結合タンパク・センサーの設計に役立つだろう。
Our prediction and design results suggest that RFAA has learned detailed features of protein–small molecule complexes. First, the network is able to make high-accuracy predictions for protein sequences and ligands that differ considerably from those in the training dataset (Figs. 2F and 3C), and prediction accuracy is higher for complexes with more-favorable computed interaction energies using the Rosetta physically based model (Fig. 2G). Second, our RFdiffusionAA-generated bilin, heme, and digoxigenin binders have very different structures than proteins that bind these compounds that are found in the PDB. RFAA should be immediately useful for modeling protein–small molecule complexes, in particular, multicomponent biomolecular assemblies for which there are few or no alternative methods available, and for designing small-molecule binding proteins and sensors.
    予測および設計の結果から、RFAAはタンパク質-低分子複合体の詳細な特徴を学習していることが示唆された。第一に、このネットワークは、トレーニングデータセットとはかなり異なるタンパク質配列やリガンドに対しても高精度の予測を行うことができ（図2Fと3C）、ロゼッタ物理ベースモデルを用いて計算された相互作用エネルギーがより好ましい複合体では、予測精度がより高くなる（図2G）。第二に、RFdiffusionAAで生成したビリン、ヘム、ジゴキシゲニン結合体は、PDBにあるこれらの化合物と結合するタンパク質とは全く異なる構造を持っている。RFAAは、タンパク質-低分子複合体、特に代替法がほとんどない、あるいは全くない多成分生体分子集合体のモデリングや、低分子結合タンパク質やセンサーの設計に直ちに役立つはずである。

# Methods summary
A detailed description of dataset curation, modeling of biological inputs, data pipeline, RFAA architecture, training, in silico design methods, and experimental validation can be found in the supplementary materials.
    データセットのキュレーション、生物学的入力のモデル化、データパイプライン、RFAAのアーキテクチャ、トレーニング、インシリコ設計法、実験的検証の詳細については、補足資料に記載されている。

# Acknowledgments

## Author contributions
Research design: R.K., I.A., M.B., F.D., D.B.; Development of the RFAA architecture and training regimen: R.K., J.W., F.D.; Evaluation of RFAA on different structure prediction tasks: P.S., R.K., I.R.H., R.M.; Development RFdiffusionAA: W.A.; Generation of designs for digoxigenin binders: P.V., G.R.L.; Execution of experiments for digoxigenin binders: P.V., G.R.L., D.V., X.L.; Generation of designs and execution of experiments for heme binders: I.K.; Generation of designs for bilin binders: W.A.; Execution of experiments for bilin binders: F.S.M.-B.; Contribution of code and ideas: I.A., G.A.S., .B., F.D.; Execution of crystallography experiments: A.K., E.B., A.K.B.; Supervision throughout the project: D.B., A.H., C.N.H.; Writing – original draft: R.K., J.W., W.A., D.B. Writing – review and editing: All authors.
    研究デザイン R.K.、I.A.、M.B.、F.D.、D.B.；RFAAのアーキテクチャとトレーニング方法の開発： RFAAのアーキテクチャとトレーニング法の開発：R.K.、J.W.、F.D.： P.S.，R.K.，I.R.H.，R.M.；RFdiffusionAAの開発：W.A.；ジゴキシゲニン結合剤のデザイン作成：P.V.，G.R.，F.D.： P.V.、G.R.L.、ジゴキシゲニン結合体の実験実施： ジゴキシゲニン結合体の実験実施：P.V.、G.R.L.、D.V.、X.L.; ヘム結合体のデザイン作成と実験実施：I.K： I.K.；ビリン結合剤のデザイン作成： W.A.；ビリン結合剤の実験実施： F.S.M.-B.、コードとアイデアの提供： I.A.、G.A.S.、.B.、F.D.、結晶学実験の実施： 結晶学実験の実施：A.K.、E.B.、A.K.B.： プロジェクト全体の監督：D.B.、A.H.、C.N.H.、執筆（原案）：R.K.、J.W： 執筆-原案：R.K.、J.W.、W.A.、D.B. 執筆-校閲・編集： 全執筆者。

## Data and materials availability
Additional data files that contain successful design models and possible training-set sequences can be found at Dryad (73). Code and neural network weights are available at https://github.com/baker-laboratory/RoseTTAFold-All-Atom and https://github.com/baker-laboratory/rf_diffusion_all_atom for RFAA and RFdiffusionAA, respectively. These repositories are archived at Zenodo (74). All other data are available in the main text or supplementary materials.
    成功したデザインモデルと可能なトレーニングセットシーケンスを含む追加データファイルは、Dryad (73)にある。RFAAのコードとニューラルネットワークの重みはhttps://github.com/baker-laboratory/RoseTTAFold-All-Atom、RFdiffusionAAのコードとニューラルネットワークの重みはhttps://github.com/baker-laboratory/rf_diffusion_all_atom。これらのリポジトリはZenodo (74)にアーカイブされている。その他のデータはすべて、本文または補足資料で入手できる。
